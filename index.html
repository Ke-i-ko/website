<!DOCTYPE html>
<html>
<head>
	<title>Image Gallery</title>
	<style>
		body {
			margin: 0;
			padding: 0;
			background-color: #f0f0f0;
			font-family: Arial, sans-serif;
		}
		
		h1 {
			padding: 10px;
			text-align: center;
			background-color: #333;
			color: #fff;
			margin: 0;
		}
		
		.gallery {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
			grid-gap: 10px;
			padding: 10px;
		}
		
		.gallery img {
			display: block;
			max-width: 100%;
			height: auto;
			transition: transform .2s;
			cursor: pointer;
		}
		
		.gallery img:hover {
			transform: scale(1.05);
		}
		
		.modal {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background-color: rgba(0, 0, 0, 0.8);
			z-index: 999;
			display: none;
			align-items: center;
			justify-content: center;
		}
		
		.modal img {
			max-width: 80%;
			max-height: 80%;
		}
		
		.close-modal {
			position: absolute;
			top: 10px;
			right: 10px;
			color: #fff;
			font-size: 30px;
			cursor: pointer;
		}
	</style>
</head>
<body>
	<h1>Image Gallery</h1>
	<div class="gallery">
		<!-- Dynamic generation of image tags -->
	</div>
	
	<div class="modal">
		<span class="close-modal">&times;</span>
		<img src="">
	</div>
	
	<script>
		// Open modal when clicking on an image
		const images = document.querySelectorAll('.gallery img');
		const modal = document.querySelector('.modal');
		const modalImg = document.querySelector('.modal img');
		const closeModal = document.querySelector('.close-modal');
		
		images.forEach((image) => {
			image.addEventListener('click', () => {
				modal.style.display = 'flex';
				modalImg.src = image.src;
			});
		});
		
		// Close modal when clicking on the close button or outside the modal
		closeModal.addEventListener('click', () => {
			modal.style.display = 'none';
		});

		// Dynamically generate image tags and set their src attributes
		const gallery = document.querySelector('.gallery');
		const imgFolder = 'img/';
		const imgExtensions = ['.jpg', '.jpeg', '.png', '.gif'];
		
		function updateGallery() {
    const xhr = new XMLHttpRequest();
    xhr.open('GET', imgFolder);
    xhr.onload = () => {
        if (xhr.status === 200) {
            const filenames = xhr.response.split('/');
            for (const filename of filenames) {
                const extension = filename.substring(filename.lastIndexOf('.')).toLowerCase();
                if (imgExtensions.includes(extension)) {
                    const img = document.createElement('img');
                    img.src = imgFolder + filename;
                    img.alt = filename;
                    gallery.appendChild(img);
                }
            }
        }
    };
    xhr.send();
}
		
		updateGallery();

// Poll the server for changes to the img folder every 5 seconds
setInterval(() => {
		const latestImage = gallery.lastChild;
		const xhr = new XMLHttpRequest();
		xhr.open('GET', imgFolder);
		xhr.onload = () => {
			if (xhr.status === 200) {
				const filenames = xhr.response.split('\n');
				const latestFilename = filenames[filenames.length - 2];
				if (latestFilename !== latestImage.alt) {
					const extension = latestFilename.substring(latestFilename.lastIndexOf('.')).toLowerCase();
					if (imgExtensions.includes(extension)) {
						const img = document.createElement('img');
						img.src = imgFolder + latestFilename;
						img.alt = latestFilename;
						gallery.appendChild(img);
					}
				}
			}
		};
		xhr.send();
	}, 5000);
</script>
</body>
</html>